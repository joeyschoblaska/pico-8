pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
#include cavediver/player.p8
#include cavediver/cave.p8

function _init()
  game_over = false
  make_player()
  make_cave()
end

function _update()
  if (not game_over) then
    update_cave()
    move_player()
    check_hit()
  else
    if (btnp(5)) _init()
  end
end

function _draw()
  cls()
  draw_cave()
  draw_player()

  if (game_over) then
    print("game over!", 44, 44, 7)
    print("your score: " .. player.score, 34, 54, 7)
    print("press ❎ to play again!", 18, 62, 6)
  else
    print("score: " .. player.score, 2, 2, 7)
  end
end

function check_hit()
  for i = player.x, player.x + 7 do
    if (cave[i + 1].top > player.y
      or cave[i + 1].btm < player.y + 7) then
      game_over = true
      sfx(1)
    end
  end
end
__gfx__
0000000000cccc0000cccc0000cccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000ccaacc00ccaacc00cc55cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000cccccc00cccccc00cccccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000ccffffccccffffcccc6776cc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000f0ff0f00f0ff0f006577560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000ffffff00ff00ff007766770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000ff00ff00ff00ff007655670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000ffff0000ffff0000766700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000555006550075500c550175501b5500c5000e50012500155001b500275000370003700037000370003700037000470004700007001b7001b7001b7001b7001b7001a7001a70019700197001870034700
001a0000177500f7500f7500f7500f75010750107501075006700067001f7001f7001b70018700057000370000700017001960019600196001960019600196001960019600196001960019600196001960019600
